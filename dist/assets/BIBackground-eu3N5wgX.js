import{R as Y,r as d,j as R}from"./index-DKmHA7yz.js";const C=({performanceConfig:h,deviceCapabilities:p,courseSlug:D})=>{const y=d.useRef(null),M=d.useRef(null),S=d.useRef([]),w=d.useRef([]),f=d.useRef({animationPhase:0,dataUpdate:0}),s=d.useMemo(()=>({streamCount:Math.min(h?.particleCount||15,8),streamSpeed:h?.staticFallback?0:1.5,kpiCount:Math.min(h?.particleCount||12,6),kpiSpeed:h?.staticFallback?0:.8,dashboardSpeed:h?.staticFallback?0:.02,colors:{primary:"#FF6348",secondary:"#FF9F43",accent:"#FFDD59",stream:"#FF6348",kpi:"#FF9F43",dashboard:"#FFDD59",success:"#2ED573",warning:"#FF9F43",background:"#2C2C2C"},kpis:[{label:"Revenue",value:"$2.4M",trend:"up",format:"currency"},{label:"Profit Margin",value:"23.5%",trend:"up",format:"percentage"},{label:"Orders",value:"12,847",trend:"up",format:"number"},{label:"Conversion",value:"4.2%",trend:"down",format:"percentage"},{label:"AOV",value:"$186",trend:"up",format:"currency"},{label:"CLTV",value:"$542",trend:"up",format:"currency"}]}),[h]);class A{constructor(t){this.canvas=t,this.particles=[],this.maxParticles=8+Math.floor(Math.random()*6),this.spawnRate=.1+Math.random()*.1,this.lastSpawn=0,this.startX=Math.random()*t.width,this.startY=t.height+50,this.endX=Math.random()*t.width,this.endY=-50,this.controlX=this.startX+(Math.random()-.5)*200,this.controlY=t.height/2+(Math.random()-.5)*100,this.opacity=.4+Math.random()*.4,this.hue=Math.random()*60}update(){s.streamSpeed!==0&&(this.lastSpawn+=this.spawnRate,this.lastSpawn>=1&&this.particles.length<this.maxParticles&&(this.particles.push({progress:0,speed:s.streamSpeed*(.8+Math.random()*.4)*.01,size:2+Math.random()*4,opacity:.8+Math.random()*.2,life:1,decay:.005+Math.random()*.005}),this.lastSpawn=0),this.particles.forEach((t,a)=>{t.progress+=t.speed,t.life-=t.decay,(t.progress>=1||t.life<=0)&&this.particles.splice(a,1)}))}draw(t){t.save(),t.globalAlpha=this.opacity,this.particles.forEach(a=>{const i=a.progress,l=Math.pow(1-i,2)*this.startX+2*(1-i)*i*this.controlX+Math.pow(i,2)*this.endX,n=Math.pow(1-i,2)*this.startY+2*(1-i)*i*this.controlY+Math.pow(i,2)*this.endY;t.save(),t.globalAlpha=a.opacity*a.life;const r=(this.hue+i*30)%360;t.fillStyle=`hsl(${r}, 70%, 60%)`,t.shadowColor=t.fillStyle,t.shadowBlur=a.size*2,t.beginPath(),t.arc(l,n,a.size,0,Math.PI*2),t.fill(),t.restore()}),t.restore()}}class T{constructor(t,a){this.canvas=t,this.kpi=a,this.x=Math.random()*(t.width-150)+75,this.y=Math.random()*(t.height-100)+50,this.vx=(Math.random()-.5)*s.kpiSpeed,this.vy=(Math.random()-.5)*s.kpiSpeed,this.opacity=.6+Math.random()*.3,this.scale=.8+Math.random()*.4,this.rotation=0,this.rotationSpeed=(Math.random()-.5)*.01,this.pulse=Math.random()*Math.PI*2,this.pulseSpeed=.03+Math.random()*.02,this.valueAnimation=0,this.animationSpeed=.02+Math.random()*.02,this.targetValue=parseFloat(this.kpi.value.replace(/[$,%]/g,"")),this.currentValue=this.targetValue*(.7+Math.random()*.3)}update(){s.kpiSpeed!==0&&(this.x+=this.vx,this.y+=this.vy,this.rotation+=this.rotationSpeed,this.pulse+=this.pulseSpeed,this.valueAnimation+=this.animationSpeed,(this.x<=75||this.x>=this.canvas.width-75)&&(this.vx*=-.8),(this.y<=50||this.y>=this.canvas.height-50)&&(this.vy*=-.8),this.x=Math.max(75,Math.min(this.canvas.width-75,this.x)),this.y=Math.max(50,Math.min(this.canvas.height-50,this.y)),Math.abs(this.currentValue-this.targetValue)>.01&&(this.currentValue+=(this.targetValue-this.currentValue)*.1))}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.scale(this.scale,this.scale),t.globalAlpha=this.opacity*(.8+Math.sin(this.pulse)*.2);const a=140,i=80;t.shadowColor=this.kpi.trend==="up"?s.colors.success:s.colors.warning,t.shadowBlur=12,t.fillStyle=s.colors.background+"CC",t.fillRect(-a/2,-i/2,a,i),t.strokeStyle=this.kpi.trend==="up"?s.colors.success:s.colors.warning,t.lineWidth=2,t.strokeRect(-a/2,-i/2,a,i),t.font="12px Arial",t.fillStyle=s.colors.kpi,t.textAlign="center",t.fillText(this.kpi.label,0,-20);let l="";this.kpi.format==="currency"?l="$"+(this.currentValue/1e6).toFixed(1)+"M":this.kpi.format==="percentage"?l=this.currentValue.toFixed(1)+"%":l=Math.floor(this.currentValue).toLocaleString(),t.font="bold 16px Arial",t.fillStyle=this.kpi.trend==="up"?s.colors.success:s.colors.warning,t.fillText(l,0,0);const n=10;t.fillStyle=this.kpi.trend==="up"?s.colors.success:s.colors.warning,t.beginPath(),this.kpi.trend==="up"?(t.moveTo(-n/2,20),t.lineTo(0,10),t.lineTo(n/2,20)):(t.moveTo(-n/2,10),t.lineTo(0,20),t.lineTo(n/2,10)),t.closePath(),t.fill(),t.strokeStyle=this.kpi.trend==="up"?s.colors.success:s.colors.warning,t.lineWidth=1,t.beginPath();for(let r=0;r<10;r++){const u=-a/2+20+r/9*(a-40),c=25+Math.sin((r+this.valueAnimation)*.5)*5+(this.kpi.trend==="up"?-r*.5:r*.5);r===0?t.moveTo(u,c):t.lineTo(u,c)}t.stroke(),t.restore()}}const P=e=>{if(s.dashboardSpeed===0)return;f.current.animationPhase+=s.dashboardSpeed,f.current.dataUpdate+=.01;const t=e.canvas.width-320,a=e.canvas.height-220,i=300,l=200;e.save(),e.fillStyle=s.colors.background+"F0",e.fillRect(t,a,i,l),e.strokeStyle=s.colors.primary,e.lineWidth=2,e.strokeRect(t,a,i,l),e.font="bold 16px Arial",e.fillStyle=s.colors.primary,e.textAlign="left",e.fillText("BI Dashboard",t+15,a+25),e.font="10px Arial",e.fillStyle=s.colors.accent;const n=new Date;e.fillText(`Updated: ${n.toLocaleTimeString()}`,t+15,a+40),e.strokeStyle=s.colors.success,e.lineWidth=2,e.beginPath();const r=t+15,u=a+60,k=i-30,c=60;for(let o=0;o<=20;o++){const m=r+o/20*k,g=u+c/2,$=Math.sin((o+f.current.dataUpdate*10)*.3)*15,B=Math.sin((o+f.current.dataUpdate*5)*.1)*20,F=g+$+B-o*.8;o===0?e.moveTo(m,F):e.lineTo(m,F)}e.stroke(),e.save(),e.globalAlpha=.2,e.fillStyle=s.colors.success,e.lineTo(r+k,u+c),e.lineTo(r,u+c),e.closePath(),e.fill(),e.restore();const v=a+140,E=[{label:"Active Users",value:"24.8K",color:s.colors.success},{label:"Sessions",value:"156.2K",color:s.colors.primary},{label:"Bounce Rate",value:"32.1%",color:s.colors.warning}];e.font="11px Arial",E.forEach((o,m)=>{const g=t+15+m*90;e.fillStyle=s.colors.accent,e.textAlign="left",e.fillText(o.label,g,v),e.font="bold 11px Arial",e.fillStyle=o.color,e.fillText(o.value,g,v+15),e.font="11px Arial"}),e.fillStyle=s.colors.success,e.beginPath(),e.arc(t+i-25,a+15,4,0,Math.PI*2),e.fill(),e.font="10px Arial",e.fillStyle=s.colors.success,e.textAlign="right",e.fillText("Live",t+i-35,a+20),e.restore()},V=e=>{S.current=[],w.current=[];for(let t=0;t<s.streamCount;t++)S.current.push(new A(e));s.kpis.slice(0,s.kpiCount).forEach(t=>{w.current.push(new T(e,t))})},b=()=>{const e=y.current;if(!e)return;const t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),S.current.forEach(a=>{a.update(),a.draw(t)}),w.current.forEach(a=>{a.update(),a.draw(t)}),P(t),(s.streamSpeed>0||s.kpiSpeed>0||s.dashboardSpeed>0)&&(M.current=requestAnimationFrame(b))};return d.useEffect(()=>{const e=y.current;if(!e)return;const t=()=>{const a=e.getBoundingClientRect();e.width=a.width*(p?.pixelRatio||1),e.height=a.height*(p?.pixelRatio||1),e.getContext("2d").scale(p?.pixelRatio||1,p?.pixelRatio||1),V(e)};return t(),window.addEventListener("resize",t),b(),()=>{window.removeEventListener("resize",t),M.current&&cancelAnimationFrame(M.current)}},[s,p]),h?.staticFallback?R.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:`linear-gradient(135deg, ${s.colors.primary} 0%, ${s.colors.secondary} 50%, ${s.colors.accent} 100%)`}}):R.jsx("canvas",{ref:y,className:"absolute inset-0 w-full h-full pointer-events-none",style:{background:"transparent",mixBlendMode:"multiply"},"aria-hidden":"true"})},z=Y.memo(C);export{z as default};
