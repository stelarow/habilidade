import{R as b,r as l,j as y}from"./index-CJotD4YZ.js";const F=({performanceConfig:d,deviceCapabilities:n,courseSlug:M})=>{const c=l.useRef(null),m=l.useRef(null),g=l.useRef([]),p=l.useRef({position:0}),f=l.useRef(null),t=l.useMemo(()=>({timelineHeight:0,timelineSpeed:0,keyframeSpacing:180,frameCount:Math.min(d?.particleCount||12,6),frameSpeed:d?.staticFallback?0:.8,frameWidth:45,frameHeight:30,cameraEnabled:!1,cameraSpeed:0,sparkleCount:0,flareIntensity:0,colors:{primary:"#FF4757",secondary:"#FF3838",accent:"#FF6B9D",timeline:"#FF4757",frame:"#FF3838",sparkle:"#FF6B9D",flare:"#FFFFFF"}}),[d]);class S{constructor(e){this.canvas=e,this.width=t.frameWidth,this.height=t.frameHeight,this.x=Math.random()*(e.width+this.width)-this.width,this.y=Math.random()*(e.height-this.height),this.vx=-t.frameSpeed*(.5+Math.random()*.5),this.opacity=.3+Math.random()*.4,this.rotation=(Math.random()-.5)*.2,this.rotationSpeed=(Math.random()-.5)*.01,this.type=["scene","transition","effect"][Math.floor(Math.random()*3)],this.scale=.8+Math.random()*.4}update(){t.frameSpeed!==0&&(this.x+=this.vx,this.rotation+=this.rotationSpeed,this.x<-this.width-50&&(this.x=this.canvas.width+50,this.y=Math.random()*(this.canvas.height-this.height)))}draw(e){switch(e.save(),e.translate(this.x+this.width/2,this.y+this.height/2),e.rotate(this.rotation),e.scale(this.scale,this.scale),e.globalAlpha=this.opacity,this.type){case"scene":this.drawScene(e);break;case"transition":this.drawTransition(e);break;case"effect":this.drawEffect(e);break}e.restore()}drawScene(e){e.strokeStyle=t.colors.frame,e.lineWidth=2,e.strokeRect(-this.width/2,-this.height/2,this.width,this.height);for(let a=0;a<4;a++){const s=-this.height/2+(a+.5)*(this.height/4);e.fillStyle=t.colors.frame,e.fillRect(-this.width/2-5,s-3,5,6),e.fillRect(this.width/2,s-3,5,6)}e.fillStyle=t.colors.primary+"30",e.fillRect(-this.width/2+4,-this.height/2+4,this.width-8,this.height-8)}drawTransition(e){e.strokeStyle=t.colors.accent,e.lineWidth=1.5,e.setLineDash([4,2]),e.strokeRect(-this.width/2,-this.height/2,this.width,this.height),e.setLineDash([]);const a=e.createLinearGradient(-this.width/2,0,this.width/2,0);a.addColorStop(0,t.colors.primary+"00"),a.addColorStop(.5,t.colors.accent+"60"),a.addColorStop(1,t.colors.secondary+"00"),e.fillStyle=a,e.fillRect(-this.width/2,-this.height/2,this.width,this.height)}drawEffect(e){e.strokeStyle=t.colors.sparkle,e.lineWidth=1,e.strokeRect(-this.width/2,-this.height/2,this.width,this.height);for(let a=0;a<3;a++){const s=(Math.random()-.5)*(this.width-10),r=(Math.random()-.5)*(this.height-10);e.fillStyle=t.colors.flare,e.beginPath(),e.arc(s,r,1,0,Math.PI*2),e.fill()}}}class w{constructor(e){this.canvas=e,this.x=e.width*.8,this.y=e.height*.2,this.rotation=0,this.bobOffset=0,this.bobSpeed=.03,this.scale=.8+Math.random()*.4,this.opacity=.6+Math.random()*.3,this.lensRotation=0,this.lensSpeed=.01,this.recordingBlink=0,this.recordingSpeed=.1}update(){!t.cameraEnabled||t.cameraSpeed===0||(this.rotation+=t.cameraSpeed,this.bobOffset+=this.bobSpeed,this.lensRotation+=this.lensSpeed,this.recordingBlink+=this.recordingSpeed)}draw(e){if(!t.cameraEnabled)return;e.save(),e.translate(this.x,this.y+Math.sin(this.bobOffset)*3),e.rotate(this.rotation),e.scale(this.scale,this.scale),e.globalAlpha=this.opacity,e.fillStyle=t.colors.secondary,e.fillRect(-30,-20,60,40),e.strokeStyle=t.colors.frame,e.lineWidth=2,e.strokeRect(-30,-20,60,40),e.save(),e.translate(20,0),e.rotate(this.lensRotation),e.strokeStyle=t.colors.accent,e.lineWidth=3,e.beginPath(),e.arc(0,0,15,0,Math.PI*2),e.stroke(),e.fillStyle=t.colors.primary+"40",e.beginPath(),e.arc(0,0,10,0,Math.PI*2),e.fill(),e.fillStyle=t.colors.flare+"80",e.beginPath(),e.arc(-3,-3,4,0,Math.PI*2),e.fill(),e.restore(),e.fillStyle=t.colors.frame,e.fillRect(-5,-30,10,15),e.fillStyle=t.colors.primary+"60",e.fillRect(-25,-15,20,12);const a=.5+Math.sin(this.recordingBlink)*.5;e.globalAlpha=this.opacity*a,e.fillStyle="#FF0000",e.beginPath(),e.arc(-20,-25,3,0,Math.PI*2),e.fill(),e.globalAlpha=this.opacity,e.font="8px Arial",e.fillStyle=t.colors.flare,e.fillText("REC",-15,-22),e.strokeStyle=t.colors.secondary,e.lineWidth=2;for(let s=0;s<3;s++){const r=s*Math.PI*2/3,h=Math.cos(r)*25,o=Math.sin(r)*25;e.beginPath(),e.moveTo(0,20),e.lineTo(h,20+o),e.stroke()}e.restore()}}const R=i=>{if(t.timelineHeight===0||t.timelineSpeed===0)return;const{width:e,height:a}=i.canvas,s=a-t.timelineHeight-20;i.save(),i.globalAlpha=.8,i.fillStyle=t.colors.timeline+"20",i.fillRect(0,s,e,t.timelineHeight),i.strokeStyle=t.colors.timeline,i.lineWidth=2,i.strokeRect(0,s,e,t.timelineHeight);const r=s+t.timelineHeight/2;p.current.position+=t.timelineSpeed;for(let o=p.current.position%t.keyframeSpacing-t.keyframeSpacing;o<e+t.keyframeSpacing;o+=t.keyframeSpacing)i.fillStyle=t.colors.accent,i.fillRect(o-2,r-15,4,30),i.beginPath(),i.moveTo(o,r-8),i.lineTo(o+6,r),i.lineTo(o,r+8),i.lineTo(o-6,r),i.closePath(),i.fill();const h=e*.3;i.fillStyle=t.colors.flare,i.fillRect(h-1,s-10,2,t.timelineHeight+20),i.beginPath(),i.moveTo(h,s-10),i.lineTo(h-8,s-20),i.lineTo(h+8,s-20),i.closePath(),i.fill(),i.restore()},k=i=>{g.current=[];for(let e=0;e<t.frameCount;e++)g.current.push(new S(i));t.cameraEnabled&&(f.current=new w(i))},u=()=>{const i=c.current;if(!i)return;const e=i.getContext("2d");e.clearRect(0,0,i.width,i.height),R(e),g.current.forEach(a=>{a.update(),a.draw(e)}),f.current&&(f.current.update(),f.current.draw(e)),(t.frameSpeed>0||t.cameraSpeed>0)&&(m.current=requestAnimationFrame(u))};return l.useEffect(()=>{const i=c.current;if(!i)return;const e=()=>{const a=i.getBoundingClientRect();i.width=a.width*(n?.pixelRatio||1),i.height=a.height*(n?.pixelRatio||1),i.getContext("2d").scale(n?.pixelRatio||1,n?.pixelRatio||1),k(i)};return e(),window.addEventListener("resize",e),u(),()=>{window.removeEventListener("resize",e),m.current&&cancelAnimationFrame(m.current)}},[t,n]),d?.staticFallback?y.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:`linear-gradient(135deg, ${t.colors.primary} 0%, ${t.colors.secondary} 50%, ${t.colors.accent} 100%)`}}):y.jsx("canvas",{ref:c,className:"absolute inset-0 w-full h-full pointer-events-none",style:{background:"transparent",mixBlendMode:"multiply"},"aria-hidden":"true"})},P=b.memo(F);export{P as default};
