import{r as e}from"./router-CWcEk_gc.js";const t=()=>{const[t,i]=e.useState("medium"),[n,s]=e.useState(!1),[r,o]=e.useState({cores:4,isMobile:!1,webglSupport:!0});return e.useEffect(()=>{const e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=e.matches;s(t);const n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),r=navigator.hardwareConcurrency||4;let a="medium";n&&r<4?a="low":r>=8&&!n&&(a="high"),i(a),o({cores:r,isMobile:n,webglSupport:!0});const c=e=>{s(e.matches),e.matches&&i("low")};return e.addEventListener("change",c),()=>{e.removeEventListener("change",c)}},[]),{performanceLevel:t,prefersReducedMotion:n,deviceCapabilities:r,shouldUseComplexAnimations:"high"===t&&!n,shouldUseBasicAnimations:"low"!==t&&!n,shouldUseStaticVersion:"low"===t||n}};function i(t={threshold:.2}){const i=e.useRef(null),[n,s]=e.useState(!1);return e.useEffect(()=>{const e=i.current;if(!e)return;const n=new IntersectionObserver(([e])=>{e.isIntersecting&&(s(!0),n.unobserve(e.target))},t);return n.observe(e),()=>n.disconnect()},[t]),[i,n]}const n=()=>{const[t,i]=e.useState({width:"undefined"!=typeof window?window.innerWidth:0,height:"undefined"!=typeof window?window.innerHeight:0,isMobile:"undefined"!=typeof window&&window.innerWidth<768,isTablet:"undefined"!=typeof window&&(window.innerWidth>=768&&window.innerWidth<1024),isDesktop:"undefined"!=typeof window&&window.innerWidth>=1024});return e.useEffect(()=>{const e=()=>{const e=window.innerWidth,t=window.innerHeight;i({width:e,height:t,isMobile:e<768,isTablet:e>=768&&e<1024,isDesktop:e>=1024})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),t};const s=new class{constructor(){this.activeAnimations=new Set,this.eventListeners=new Map,this.canvasContexts=new Set,this.timers=new Set,this.isTabActive=!0,this.memoryThreshold=104857600,this.setupVisibilityAPI(),this.setupMemoryMonitoring()}setupVisibilityAPI(){const e=()=>{this.isTabActive=!document.hidden,this.isTabActive?this.resumeAllAnimations():this.pauseAllAnimations()};document.addEventListener("visibilitychange",e),this.eventListeners.set("document:visibilitychange",e)}setupMemoryMonitoring(){if(!("memory"in performance))return;const e=setInterval(()=>{performance.memory.usedJSHeapSize/1024/1024>150&&this.emergencyCleanup()},3e4);this.timers.add(e)}registerAnimation(e,t,i,n){const s={id:e,pauseFn:t||(()=>{}),resumeFn:i||(()=>{}),cleanupFn:n||(()=>{}),isPaused:!1};return this.activeAnimations.add(s),s}pauseAllAnimations(){this.activeAnimations.forEach(e=>{e.isPaused||(e.pauseFn(),e.isPaused=!0)})}resumeAllAnimations(){this.isTabActive&&this.activeAnimations.forEach(e=>{e.isPaused&&(e.resumeFn(),e.isPaused=!1)})}unregisterAnimation(e){e&&e.cleanupFn&&e.cleanupFn(),this.activeAnimations.delete(e)}registerEventListener(e,t,i,n){const s=`${e.constructor.name}:${t}`;e.addEventListener(t,i,n),this.eventListeners.has(s)||this.eventListeners.set(s,[]),this.eventListeners.get(s).push({element:e,handler:i,options:n})}registerCanvasContext(e){this.canvasContexts.add(e)}emergencyCleanup(){this.pauseAllAnimations(),window.gc&&window.gc(),this.canvasContexts.forEach(e=>{e&&e.canvas&&e.clearRect(0,0,e.canvas.width,e.canvas.height)}),setTimeout(()=>{this.isTabActive&&this.resumeAllAnimations()},2e3)}destroy(){this.activeAnimations.forEach(e=>{this.unregisterAnimation(e)}),this.activeAnimations.clear(),this.eventListeners.forEach((e,t)=>{e.forEach(({element:e,handler:i,options:n})=>{e.removeEventListener(t.split(":")[1],i,n)})}),this.eventListeners.clear(),this.timers.forEach(e=>{clearInterval(e)}),this.timers.clear(),this.canvasContexts.clear()}getStats(){const e="memory"in performance?{used:Math.round(performance.memory.usedJSHeapSize/1024/1024),total:Math.round(performance.memory.totalJSHeapSize/1024/1024),limit:Math.round(performance.memory.jsHeapSizeLimit/1024/1024)}:{used:"N/A",total:"N/A",limit:"N/A"};return{activeAnimations:this.activeAnimations.size,eventListeners:this.eventListeners.size,canvasContexts:this.canvasContexts.size,timers:this.timers.size,isTabActive:this.isTabActive,memory:e}}};export{i as a,n as b,s as m,t as u};
