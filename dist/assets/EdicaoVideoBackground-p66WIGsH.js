import{R as b,r as l,j as S}from"./index-BJDMVPWl.js";const T=({performanceConfig:r,deviceCapabilities:d,courseSlug:E})=>{const f=l.useRef(null),m=l.useRef(null),c=l.useRef([]),u=l.useRef({position:0}),i=l.useMemo(()=>({timelineHeight:80,timelineSpeed:r?.staticFallback?0:1,keyframeSpacing:120,frameCount:Math.min(r?.particleCount||40,12),frameSpeed:r?.staticFallback?0:.8,frameWidth:60,frameHeight:40,sparkleCount:Math.min(r?.particleCount||20,6),flareIntensity:r?.staticFallback?0:.6,colors:{primary:"#FF4757",secondary:"#FF3838",accent:"#FF6B9D",timeline:"#FF4757",frame:"#FF3838",sparkle:"#FF6B9D",flare:"#FFFFFF"}}),[r]);class M{constructor(t){this.canvas=t,this.width=i.frameWidth,this.height=i.frameHeight,this.x=Math.random()*(t.width+this.width)-this.width,this.y=Math.random()*(t.height-this.height),this.vx=-i.frameSpeed*(.5+Math.random()*.5),this.opacity=.3+Math.random()*.4,this.rotation=(Math.random()-.5)*.2,this.rotationSpeed=(Math.random()-.5)*.01,this.type=["scene","transition","effect"][Math.floor(Math.random()*3)],this.scale=.8+Math.random()*.4}update(){i.frameSpeed!==0&&(this.x+=this.vx,this.rotation+=this.rotationSpeed,this.x<-this.width-50&&(this.x=this.canvas.width+50,this.y=Math.random()*(this.canvas.height-this.height)))}draw(t){switch(t.save(),t.translate(this.x+this.width/2,this.y+this.height/2),t.rotate(this.rotation),t.scale(this.scale,this.scale),t.globalAlpha=this.opacity,this.type){case"scene":this.drawScene(t);break;case"transition":this.drawTransition(t);break;case"effect":this.drawEffect(t);break}t.restore()}drawScene(t){t.strokeStyle=i.colors.frame,t.lineWidth=2,t.strokeRect(-this.width/2,-this.height/2,this.width,this.height);for(let s=0;s<4;s++){const h=-this.height/2+(s+.5)*(this.height/4);t.fillStyle=i.colors.frame,t.fillRect(-this.width/2-5,h-3,5,6),t.fillRect(this.width/2,h-3,5,6)}t.fillStyle=i.colors.primary+"30",t.fillRect(-this.width/2+4,-this.height/2+4,this.width-8,this.height-8)}drawTransition(t){t.strokeStyle=i.colors.accent,t.lineWidth=1.5,t.setLineDash([4,2]),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),t.setLineDash([]);const s=t.createLinearGradient(-this.width/2,0,this.width/2,0);s.addColorStop(0,i.colors.primary+"00"),s.addColorStop(.5,i.colors.accent+"60"),s.addColorStop(1,i.colors.secondary+"00"),t.fillStyle=s,t.fillRect(-this.width/2,-this.height/2,this.width,this.height)}drawEffect(t){t.strokeStyle=i.colors.sparkle,t.lineWidth=1,t.strokeRect(-this.width/2,-this.height/2,this.width,this.height);for(let s=0;s<3;s++){const h=(Math.random()-.5)*(this.width-10),n=(Math.random()-.5)*(this.height-10);t.fillStyle=i.colors.flare,t.beginPath(),t.arc(h,n,1,0,Math.PI*2),t.fill()}}}class R{constructor(t){this.canvas=t,this.x=Math.random()*t.width,this.y=Math.random()*t.height,this.vx=(Math.random()-.5)*2,this.vy=(Math.random()-.5)*2,this.life=1,this.decay=.005+Math.random()*.01,this.size=1+Math.random()*3,this.twinkle=Math.random()*Math.PI*2,this.twinkleSpeed=.1+Math.random()*.1}update(){i.flareIntensity!==0&&(this.x+=this.vx,this.y+=this.vy,this.life-=this.decay,this.twinkle+=this.twinkleSpeed,this.life<=0&&(this.x=Math.random()*this.canvas.width,this.y=Math.random()*this.canvas.height,this.life=1))}draw(t){if(this.life<=0)return;t.save(),t.translate(this.x,this.y);const s=this.life*Math.sin(this.twinkle)*i.flareIntensity;t.globalAlpha=Math.max(0,s),t.fillStyle=i.colors.flare,t.beginPath();const h=4,n=this.size,o=this.size*.5;for(let a=0;a<h*2;a++){const w=a%2===0?n:o,y=a*Math.PI/h,p=Math.cos(y)*w,k=Math.sin(y)*w;a===0?t.moveTo(p,k):t.lineTo(p,k)}t.closePath(),t.fill(),t.restore()}}const F=e=>{const{width:t,height:s}=e.canvas,h=s-i.timelineHeight-20;e.save(),e.globalAlpha=.8,e.fillStyle=i.colors.timeline+"20",e.fillRect(0,h,t,i.timelineHeight),e.strokeStyle=i.colors.timeline,e.lineWidth=2,e.strokeRect(0,h,t,i.timelineHeight);const n=h+i.timelineHeight/2;u.current.position+=i.timelineSpeed;for(let a=u.current.position%i.keyframeSpacing-i.keyframeSpacing;a<t+i.keyframeSpacing;a+=i.keyframeSpacing)e.fillStyle=i.colors.accent,e.fillRect(a-2,n-15,4,30),e.beginPath(),e.moveTo(a,n-8),e.lineTo(a+6,n),e.lineTo(a,n+8),e.lineTo(a-6,n),e.closePath(),e.fill();const o=t*.3;e.fillStyle=i.colors.flare,e.fillRect(o-1,h-10,2,i.timelineHeight+20),e.beginPath(),e.moveTo(o,h-10),e.lineTo(o-8,h-20),e.lineTo(o+8,h-20),e.closePath(),e.fill(),e.restore()},v=e=>{c.current=[];for(let t=0;t<i.frameCount;t++)c.current.push(new M(e));for(let t=0;t<i.sparkleCount;t++)c.current.push(new R(e))},g=()=>{const e=f.current;if(!e)return;const t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),F(t),c.current.forEach(s=>{s.update(),s.draw(t)}),(i.timelineSpeed>0||i.frameSpeed>0)&&(m.current=requestAnimationFrame(g))};return l.useEffect(()=>{const e=f.current;if(!e)return;const t=()=>{const s=e.getBoundingClientRect();e.width=s.width*(d?.pixelRatio||1),e.height=s.height*(d?.pixelRatio||1),e.getContext("2d").scale(d?.pixelRatio||1,d?.pixelRatio||1),v(e)};return t(),window.addEventListener("resize",t),g(),()=>{window.removeEventListener("resize",t),m.current&&cancelAnimationFrame(m.current)}},[i,d]),r?.staticFallback?S.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:`linear-gradient(135deg, ${i.colors.primary} 0%, ${i.colors.secondary} 50%, ${i.colors.accent} 100%)`}}):S.jsx("canvas",{ref:f,className:"absolute inset-0 w-full h-full pointer-events-none",style:{background:"transparent",mixBlendMode:"multiply"},"aria-hidden":"true"})},H=b.memo(T);export{H as default};
