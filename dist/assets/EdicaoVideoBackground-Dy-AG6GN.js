import{R,r as o,j as p}from"./index-DKmHA7yz.js";const k=({performanceConfig:n,deviceCapabilities:l,courseSlug:F})=>{const c=o.useRef(null),f=o.useRef(null),m=o.useRef([]),g=o.useRef({position:0}),i=o.useMemo(()=>({timelineHeight:60,timelineSpeed:n?.staticFallback?0:.6,keyframeSpacing:180,frameCount:Math.min(n?.particleCount||6,2),frameSpeed:n?.staticFallback?0:.4,frameWidth:45,frameHeight:30,sparkleCount:0,flareIntensity:0,colors:{primary:"#FF4757",secondary:"#FF3838",accent:"#FF6B9D",timeline:"#FF4757",frame:"#FF3838",sparkle:"#FF6B9D",flare:"#FFFFFF"}}),[n]);class w{constructor(e){this.canvas=e,this.width=i.frameWidth,this.height=i.frameHeight,this.x=Math.random()*(e.width+this.width)-this.width,this.y=Math.random()*(e.height-this.height),this.vx=-i.frameSpeed*(.5+Math.random()*.5),this.opacity=.3+Math.random()*.4,this.rotation=(Math.random()-.5)*.2,this.rotationSpeed=(Math.random()-.5)*.01,this.type=["scene","transition","effect"][Math.floor(Math.random()*3)],this.scale=.8+Math.random()*.4}update(){i.frameSpeed!==0&&(this.x+=this.vx,this.rotation+=this.rotationSpeed,this.x<-this.width-50&&(this.x=this.canvas.width+50,this.y=Math.random()*(this.canvas.height-this.height)))}draw(e){switch(e.save(),e.translate(this.x+this.width/2,this.y+this.height/2),e.rotate(this.rotation),e.scale(this.scale,this.scale),e.globalAlpha=this.opacity,this.type){case"scene":this.drawScene(e);break;case"transition":this.drawTransition(e);break;case"effect":this.drawEffect(e);break}e.restore()}drawScene(e){e.strokeStyle=i.colors.frame,e.lineWidth=2,e.strokeRect(-this.width/2,-this.height/2,this.width,this.height);for(let s=0;s<4;s++){const a=-this.height/2+(s+.5)*(this.height/4);e.fillStyle=i.colors.frame,e.fillRect(-this.width/2-5,a-3,5,6),e.fillRect(this.width/2,a-3,5,6)}e.fillStyle=i.colors.primary+"30",e.fillRect(-this.width/2+4,-this.height/2+4,this.width-8,this.height-8)}drawTransition(e){e.strokeStyle=i.colors.accent,e.lineWidth=1.5,e.setLineDash([4,2]),e.strokeRect(-this.width/2,-this.height/2,this.width,this.height),e.setLineDash([]);const s=e.createLinearGradient(-this.width/2,0,this.width/2,0);s.addColorStop(0,i.colors.primary+"00"),s.addColorStop(.5,i.colors.accent+"60"),s.addColorStop(1,i.colors.secondary+"00"),e.fillStyle=s,e.fillRect(-this.width/2,-this.height/2,this.width,this.height)}drawEffect(e){e.strokeStyle=i.colors.sparkle,e.lineWidth=1,e.strokeRect(-this.width/2,-this.height/2,this.width,this.height);for(let s=0;s<3;s++){const a=(Math.random()-.5)*(this.width-10),h=(Math.random()-.5)*(this.height-10);e.fillStyle=i.colors.flare,e.beginPath(),e.arc(a,h,1,0,Math.PI*2),e.fill()}}}const y=t=>{const{width:e,height:s}=t.canvas,a=s-i.timelineHeight-20;t.save(),t.globalAlpha=.8,t.fillStyle=i.colors.timeline+"20",t.fillRect(0,a,e,i.timelineHeight),t.strokeStyle=i.colors.timeline,t.lineWidth=2,t.strokeRect(0,a,e,i.timelineHeight);const h=a+i.timelineHeight/2;g.current.position+=i.timelineSpeed;for(let r=g.current.position%i.keyframeSpacing-i.keyframeSpacing;r<e+i.keyframeSpacing;r+=i.keyframeSpacing)t.fillStyle=i.colors.accent,t.fillRect(r-2,h-15,4,30),t.beginPath(),t.moveTo(r,h-8),t.lineTo(r+6,h),t.lineTo(r,h+8),t.lineTo(r-6,h),t.closePath(),t.fill();const d=e*.3;t.fillStyle=i.colors.flare,t.fillRect(d-1,a-10,2,i.timelineHeight+20),t.beginPath(),t.moveTo(d,a-10),t.lineTo(d-8,a-20),t.lineTo(d+8,a-20),t.closePath(),t.fill(),t.restore()},S=t=>{m.current=[];for(let e=0;e<i.frameCount;e++)m.current.push(new w(t))},u=()=>{const t=c.current;if(!t)return;const e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),y(e),m.current.forEach(s=>{s.update(),s.draw(e)}),(i.timelineSpeed>0||i.frameSpeed>0)&&(f.current=requestAnimationFrame(u))};return o.useEffect(()=>{const t=c.current;if(!t)return;const e=()=>{const s=t.getBoundingClientRect();t.width=s.width*(l?.pixelRatio||1),t.height=s.height*(l?.pixelRatio||1),t.getContext("2d").scale(l?.pixelRatio||1,l?.pixelRatio||1),S(t)};return e(),window.addEventListener("resize",e),u(),()=>{window.removeEventListener("resize",e),f.current&&cancelAnimationFrame(f.current)}},[i,l]),n?.staticFallback?p.jsx("div",{className:"absolute inset-0 opacity-10",style:{background:`linear-gradient(135deg, ${i.colors.primary} 0%, ${i.colors.secondary} 50%, ${i.colors.accent} 100%)`}}):p.jsx("canvas",{ref:c,className:"absolute inset-0 w-full h-full pointer-events-none",style:{background:"transparent",mixBlendMode:"multiply"},"aria-hidden":"true"})},v=R.memo(k);export{v as default};
